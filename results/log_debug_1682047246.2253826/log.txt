!!!!!!!!!!! time head: 16 !!!!!!!!!!!!!
!!! ABS_weight: 1.0
!!! MSE_weight: 0
!!! SSIM_weight: 0
contructing model...
ds_background:  3
num_hiddens:  256
num_residual_layers:  4
num_residual_hiddens:  128
suf_method:  conv
n_frames:  16
Loading Motion Encoder: Encoder_Motion...
{'image_size': 32, 'in_channels': 256, 'out_channels': 256, 'model_channels': 32, 'attention_resolutions': [4, 2, 1], 'num_res_blocks': 2, 'channel_mult': [1, 2, 4, 4], 'num_heads': 8, 'use_scale_shift_norm': True, 'resblock_updown': True, 'cond_model': False}
before loop:
num of input blocks: 1
num of input attns: 1
DDPM: Running in eps-prediction mode
show encoding indices: torch.Size([2048])
show encodings: torch.Size([2048, 24576])
show encoding indices: torch.Size([512])
show encodings: torch.Size([512, 24576])
show encoding indices: torch.Size([2048])
show encodings: torch.Size([2048, 24576])
bg_quantized torch.Size([2, 1, 256, 32, 32])
id_quantized torch.Size([2, 1, 256, 16, 16])
mo_quantized torch.Size([2, 16, 256, 8, 8])
after rearrange quantized
xbg_quantized torch.Size([2, 256, 1024])
xid_quantized torch.Size([2, 256, 256])
xmo_quantized torch.Size([2, 256, 1024])
show z shape torch.Size([2, 256, 2304])
h shape:  torch.Size([2, 256, 2304])
h_bg shape:  torch.Size([2, 256, 32, 32])
h_id shape:  torch.Size([2, 256, 16, 16])
h_mo shape:  torch.Size([2, 256, 32, 32])
	h_bg shape after module:  torch.Size([2, 32, 32, 32])
	h_id shape after module:  torch.Size([2, 32, 16, 16])
	h_mo shape after module:  torch.Size([2, 32, 32, 32])
	res, t:  32 16
	h_bg shape after view:  torch.Size([2, 32, 1024])
	h_id shape after view:  torch.Size([2, 32, 256])
	h_mo shape after view:  torch.Size([2, 32, 1024])
	h shape after input_attn:  torch.Size([2, 32, 2304])
	h_bg shape after res*res:  torch.Size([2, 32, 32, 32])
	h_id shape after res*res:  torch.Size([2, 32, 16, 16])
	h_mo shape after res*res:  torch.Size([2, 32, 32, 32])
	in loop: 0
	append h_bg shape:  torch.Size([2, 32, 32, 32])
	append h_id shape:  torch.Size([2, 32, 16, 16])
	append h_mo shape:  torch.Size([2, 32, 32, 32])

	h_bg shape after module:  torch.Size([2, 32, 32, 32])
	h_id shape after module:  torch.Size([2, 32, 16, 16])
	h_mo shape after module:  torch.Size([2, 32, 32, 32])
	res, t:  32 16
	h_bg shape after view:  torch.Size([2, 32, 1024])
	h_id shape after view:  torch.Size([2, 32, 256])
	h_mo shape after view:  torch.Size([2, 32, 1024])
	h shape after input_attn:  torch.Size([2, 32, 2304])
	h_bg shape after res*res:  torch.Size([2, 32, 32, 32])
	h_id shape after res*res:  torch.Size([2, 32, 16, 16])
	h_mo shape after res*res:  torch.Size([2, 32, 32, 32])
	in loop: 1
	append h_bg shape:  torch.Size([2, 32, 32, 32])
	append h_id shape:  torch.Size([2, 32, 16, 16])
	append h_mo shape:  torch.Size([2, 32, 32, 32])

	h_bg shape after module:  torch.Size([2, 32, 32, 32])
	h_id shape after module:  torch.Size([2, 32, 16, 16])
	h_mo shape after module:  torch.Size([2, 32, 32, 32])
	res, t:  32 16
	h_bg shape after view:  torch.Size([2, 32, 1024])
	h_id shape after view:  torch.Size([2, 32, 256])
	h_mo shape after view:  torch.Size([2, 32, 1024])
	h shape after input_attn:  torch.Size([2, 32, 2304])
	h_bg shape after res*res:  torch.Size([2, 32, 32, 32])
	h_id shape after res*res:  torch.Size([2, 32, 16, 16])
	h_mo shape after res*res:  torch.Size([2, 32, 32, 32])
	in loop: 2
	append h_bg shape:  torch.Size([2, 32, 32, 32])
	append h_id shape:  torch.Size([2, 32, 16, 16])
	append h_mo shape:  torch.Size([2, 32, 32, 32])

	h_bg shape after module:  torch.Size([2, 32, 16, 16])
	h_id shape after module:  torch.Size([2, 32, 8, 8])
	h_mo shape after module:  torch.Size([2, 32, 16, 16])
	res, t:  16 8
	h_bg shape after view:  torch.Size([2, 32, 256])
	h_id shape after view:  torch.Size([2, 32, 64])
	h_mo shape after view:  torch.Size([2, 32, 256])
	h shape after input_attn:  torch.Size([2, 32, 576])
	h_bg shape after res*res:  torch.Size([2, 32, 16, 16])
	h_id shape after res*res:  torch.Size([2, 32, 8, 8])
	h_mo shape after res*res:  torch.Size([2, 32, 16, 16])
	in loop: 3
	append h_bg shape:  torch.Size([2, 32, 16, 16])
	append h_id shape:  torch.Size([2, 32, 8, 8])
	append h_mo shape:  torch.Size([2, 32, 16, 16])

	h_bg shape after module:  torch.Size([2, 64, 16, 16])
	h_id shape after module:  torch.Size([2, 64, 8, 8])
	h_mo shape after module:  torch.Size([2, 64, 16, 16])
	res, t:  16 8
	h_bg shape after view:  torch.Size([2, 64, 256])
	h_id shape after view:  torch.Size([2, 64, 64])
	h_mo shape after view:  torch.Size([2, 64, 256])
	h shape after input_attn:  torch.Size([2, 64, 576])
	h_bg shape after res*res:  torch.Size([2, 64, 16, 16])
	h_id shape after res*res:  torch.Size([2, 64, 8, 8])
	h_mo shape after res*res:  torch.Size([2, 64, 16, 16])
	in loop: 4
	append h_bg shape:  torch.Size([2, 64, 16, 16])
	append h_id shape:  torch.Size([2, 64, 8, 8])
	append h_mo shape:  torch.Size([2, 64, 16, 16])

	h_bg shape after module:  torch.Size([2, 64, 16, 16])
	h_id shape after module:  torch.Size([2, 64, 8, 8])
	h_mo shape after module:  torch.Size([2, 64, 16, 16])
	res, t:  16 8
	h_bg shape after view:  torch.Size([2, 64, 256])
	h_id shape after view:  torch.Size([2, 64, 64])
	h_mo shape after view:  torch.Size([2, 64, 256])
	h shape after input_attn:  torch.Size([2, 64, 576])
	h_bg shape after res*res:  torch.Size([2, 64, 16, 16])
	h_id shape after res*res:  torch.Size([2, 64, 8, 8])
	h_mo shape after res*res:  torch.Size([2, 64, 16, 16])
	in loop: 5
	append h_bg shape:  torch.Size([2, 64, 16, 16])
	append h_id shape:  torch.Size([2, 64, 8, 8])
	append h_mo shape:  torch.Size([2, 64, 16, 16])

	h_bg shape after module:  torch.Size([2, 64, 8, 8])
	h_id shape after module:  torch.Size([2, 64, 4, 4])
	h_mo shape after module:  torch.Size([2, 64, 8, 8])
	res, t:  8 4
	h_bg shape after view:  torch.Size([2, 64, 64])
	h_id shape after view:  torch.Size([2, 64, 16])
	h_mo shape after view:  torch.Size([2, 64, 64])
	h shape after input_attn:  torch.Size([2, 64, 144])
	h_bg shape after res*res:  torch.Size([2, 64, 8, 8])
	h_id shape after res*res:  torch.Size([2, 64, 4, 4])
	h_mo shape after res*res:  torch.Size([2, 64, 8, 8])
	in loop: 6
	append h_bg shape:  torch.Size([2, 64, 8, 8])
	append h_id shape:  torch.Size([2, 64, 4, 4])
	append h_mo shape:  torch.Size([2, 64, 8, 8])

	h_bg shape after module:  torch.Size([2, 128, 8, 8])
	h_id shape after module:  torch.Size([2, 128, 4, 4])
	h_mo shape after module:  torch.Size([2, 128, 8, 8])
	res, t:  8 4
	h_bg shape after view:  torch.Size([2, 128, 64])
	h_id shape after view:  torch.Size([2, 128, 16])
	h_mo shape after view:  torch.Size([2, 128, 64])
	h shape after input_attn:  torch.Size([2, 128, 144])
	h_bg shape after res*res:  torch.Size([2, 128, 8, 8])
	h_id shape after res*res:  torch.Size([2, 128, 4, 4])
	h_mo shape after res*res:  torch.Size([2, 128, 8, 8])
	in loop: 7
	append h_bg shape:  torch.Size([2, 128, 8, 8])
	append h_id shape:  torch.Size([2, 128, 4, 4])
	append h_mo shape:  torch.Size([2, 128, 8, 8])

	h_bg shape after module:  torch.Size([2, 128, 8, 8])
	h_id shape after module:  torch.Size([2, 128, 4, 4])
	h_mo shape after module:  torch.Size([2, 128, 8, 8])
	res, t:  8 4
	h_bg shape after view:  torch.Size([2, 128, 64])
	h_id shape after view:  torch.Size([2, 128, 16])
	h_mo shape after view:  torch.Size([2, 128, 64])
	h shape after input_attn:  torch.Size([2, 128, 144])
	h_bg shape after res*res:  torch.Size([2, 128, 8, 8])
	h_id shape after res*res:  torch.Size([2, 128, 4, 4])
	h_mo shape after res*res:  torch.Size([2, 128, 8, 8])
	in loop: 8
	append h_bg shape:  torch.Size([2, 128, 8, 8])
	append h_id shape:  torch.Size([2, 128, 4, 4])
	append h_mo shape:  torch.Size([2, 128, 8, 8])

	h_bg shape after module:  torch.Size([2, 128, 4, 4])
	h_id shape after module:  torch.Size([2, 128, 2, 2])
	h_mo shape after module:  torch.Size([2, 128, 4, 4])
	res, t:  4 2
	h_bg shape after view:  torch.Size([2, 128, 16])
	h_id shape after view:  torch.Size([2, 128, 4])
	h_mo shape after view:  torch.Size([2, 128, 16])
	h shape after input_attn:  torch.Size([2, 128, 36])
	h_bg shape after res*res:  torch.Size([2, 128, 4, 4])
	h_id shape after res*res:  torch.Size([2, 128, 2, 2])
	h_mo shape after res*res:  torch.Size([2, 128, 4, 4])
	in loop: 9
	append h_bg shape:  torch.Size([2, 128, 4, 4])
	append h_id shape:  torch.Size([2, 128, 2, 2])
	append h_mo shape:  torch.Size([2, 128, 4, 4])

	h_bg shape after module:  torch.Size([2, 128, 4, 4])
	h_id shape after module:  torch.Size([2, 128, 2, 2])
	h_mo shape after module:  torch.Size([2, 128, 4, 4])
	res, t:  4 2
	h_bg shape after view:  torch.Size([2, 128, 16])
	h_id shape after view:  torch.Size([2, 128, 4])
	h_mo shape after view:  torch.Size([2, 128, 16])
	h shape after input_attn:  torch.Size([2, 128, 36])
	h_bg shape after res*res:  torch.Size([2, 128, 4, 4])
	h_id shape after res*res:  torch.Size([2, 128, 2, 2])
	h_mo shape after res*res:  torch.Size([2, 128, 4, 4])
	in loop: 10
	append h_bg shape:  torch.Size([2, 128, 4, 4])
	append h_id shape:  torch.Size([2, 128, 2, 2])
	append h_mo shape:  torch.Size([2, 128, 4, 4])

	h_bg shape after module:  torch.Size([2, 128, 4, 4])
	h_id shape after module:  torch.Size([2, 128, 2, 2])
	h_mo shape after module:  torch.Size([2, 128, 4, 4])
	res, t:  4 2
	h_bg shape after view:  torch.Size([2, 128, 16])
	h_id shape after view:  torch.Size([2, 128, 4])
	h_mo shape after view:  torch.Size([2, 128, 16])
	h shape after input_attn:  torch.Size([2, 128, 36])
	h_bg shape after res*res:  torch.Size([2, 128, 4, 4])
	h_id shape after res*res:  torch.Size([2, 128, 2, 2])
	h_mo shape after res*res:  torch.Size([2, 128, 4, 4])
	in loop: 11
	append h_bg shape:  torch.Size([2, 128, 4, 4])
	append h_id shape:  torch.Size([2, 128, 2, 2])
	append h_mo shape:  torch.Size([2, 128, 4, 4])

start up sampling
cat out h shape:  torch.Size([2, 256, 2304])
show model_out in p_losses torch.Size([2, 256, 2304])
[Time 2.881] [Diffusion 0.000000]
show encoding indices: torch.Size([2048])
show encodings: torch.Size([2048, 24576])
show encoding indices: torch.Size([512])
show encodings: torch.Size([512, 24576])
show encoding indices: torch.Size([2048])
show encodings: torch.Size([2048, 24576])
bg_quantized torch.Size([2, 1, 256, 32, 32])
id_quantized torch.Size([2, 1, 256, 16, 16])
mo_quantized torch.Size([2, 16, 256, 8, 8])
after rearrange quantized
xbg_quantized torch.Size([2, 256, 1024])
xid_quantized torch.Size([2, 256, 256])
xmo_quantized torch.Size([2, 256, 1024])
show z shape torch.Size([2, 256, 2304])
h shape:  torch.Size([2, 256, 2304])
h_bg shape:  torch.Size([2, 256, 32, 32])
h_id shape:  torch.Size([2, 256, 16, 16])
h_mo shape:  torch.Size([2, 256, 32, 32])
	h_bg shape after module:  torch.Size([2, 32, 32, 32])
	h_id shape after module:  torch.Size([2, 32, 16, 16])
	h_mo shape after module:  torch.Size([2, 32, 32, 32])
	res, t:  32 16
	h_bg shape after view:  torch.Size([2, 32, 1024])
	h_id shape after view:  torch.Size([2, 32, 256])
	h_mo shape after view:  torch.Size([2, 32, 1024])
	h shape after input_attn:  torch.Size([2, 32, 2304])
	h_bg shape after res*res:  torch.Size([2, 32, 32, 32])
	h_id shape after res*res:  torch.Size([2, 32, 16, 16])
	h_mo shape after res*res:  torch.Size([2, 32, 32, 32])
	in loop: 0
	append h_bg shape:  torch.Size([2, 32, 32, 32])
	append h_id shape:  torch.Size([2, 32, 16, 16])
	append h_mo shape:  torch.Size([2, 32, 32, 32])

	h_bg shape after module:  torch.Size([2, 32, 32, 32])
	h_id shape after module:  torch.Size([2, 32, 16, 16])
	h_mo shape after module:  torch.Size([2, 32, 32, 32])
	res, t:  32 16
	h_bg shape after view:  torch.Size([2, 32, 1024])
	h_id shape after view:  torch.Size([2, 32, 256])
	h_mo shape after view:  torch.Size([2, 32, 1024])
	h shape after input_attn:  torch.Size([2, 32, 2304])
	h_bg shape after res*res:  torch.Size([2, 32, 32, 32])
	h_id shape after res*res:  torch.Size([2, 32, 16, 16])
	h_mo shape after res*res:  torch.Size([2, 32, 32, 32])
	in loop: 1
	append h_bg shape:  torch.Size([2, 32, 32, 32])
	append h_id shape:  torch.Size([2, 32, 16, 16])
	append h_mo shape:  torch.Size([2, 32, 32, 32])

	h_bg shape after module:  torch.Size([2, 32, 32, 32])
	h_id shape after module:  torch.Size([2, 32, 16, 16])
	h_mo shape after module:  torch.Size([2, 32, 32, 32])
	res, t:  32 16
	h_bg shape after view:  torch.Size([2, 32, 1024])
	h_id shape after view:  torch.Size([2, 32, 256])
	h_mo shape after view:  torch.Size([2, 32, 1024])
	h shape after input_attn:  torch.Size([2, 32, 2304])
	h_bg shape after res*res:  torch.Size([2, 32, 32, 32])
	h_id shape after res*res:  torch.Size([2, 32, 16, 16])
	h_mo shape after res*res:  torch.Size([2, 32, 32, 32])
	in loop: 2
	append h_bg shape:  torch.Size([2, 32, 32, 32])
	append h_id shape:  torch.Size([2, 32, 16, 16])
	append h_mo shape:  torch.Size([2, 32, 32, 32])

	h_bg shape after module:  torch.Size([2, 32, 16, 16])
	h_id shape after module:  torch.Size([2, 32, 8, 8])
	h_mo shape after module:  torch.Size([2, 32, 16, 16])
	res, t:  16 8
	h_bg shape after view:  torch.Size([2, 32, 256])
	h_id shape after view:  torch.Size([2, 32, 64])
	h_mo shape after view:  torch.Size([2, 32, 256])
	h shape after input_attn:  torch.Size([2, 32, 576])
	h_bg shape after res*res:  torch.Size([2, 32, 16, 16])
	h_id shape after res*res:  torch.Size([2, 32, 8, 8])
	h_mo shape after res*res:  torch.Size([2, 32, 16, 16])
	in loop: 3
	append h_bg shape:  torch.Size([2, 32, 16, 16])
	append h_id shape:  torch.Size([2, 32, 8, 8])
	append h_mo shape:  torch.Size([2, 32, 16, 16])

	h_bg shape after module:  torch.Size([2, 64, 16, 16])
	h_id shape after module:  torch.Size([2, 64, 8, 8])
	h_mo shape after module:  torch.Size([2, 64, 16, 16])
	res, t:  16 8
	h_bg shape after view:  torch.Size([2, 64, 256])
	h_id shape after view:  torch.Size([2, 64, 64])
	h_mo shape after view:  torch.Size([2, 64, 256])
	h shape after input_attn:  torch.Size([2, 64, 576])
	h_bg shape after res*res:  torch.Size([2, 64, 16, 16])
	h_id shape after res*res:  torch.Size([2, 64, 8, 8])
	h_mo shape after res*res:  torch.Size([2, 64, 16, 16])
	in loop: 4
	append h_bg shape:  torch.Size([2, 64, 16, 16])
	append h_id shape:  torch.Size([2, 64, 8, 8])
	append h_mo shape:  torch.Size([2, 64, 16, 16])

	h_bg shape after module:  torch.Size([2, 64, 16, 16])
	h_id shape after module:  torch.Size([2, 64, 8, 8])
	h_mo shape after module:  torch.Size([2, 64, 16, 16])
	res, t:  16 8
	h_bg shape after view:  torch.Size([2, 64, 256])
	h_id shape after view:  torch.Size([2, 64, 64])
	h_mo shape after view:  torch.Size([2, 64, 256])
	h shape after input_attn:  torch.Size([2, 64, 576])
	h_bg shape after res*res:  torch.Size([2, 64, 16, 16])
	h_id shape after res*res:  torch.Size([2, 64, 8, 8])
	h_mo shape after res*res:  torch.Size([2, 64, 16, 16])
	in loop: 5
	append h_bg shape:  torch.Size([2, 64, 16, 16])
	append h_id shape:  torch.Size([2, 64, 8, 8])
	append h_mo shape:  torch.Size([2, 64, 16, 16])

	h_bg shape after module:  torch.Size([2, 64, 8, 8])
	h_id shape after module:  torch.Size([2, 64, 4, 4])
	h_mo shape after module:  torch.Size([2, 64, 8, 8])
	res, t:  8 4
	h_bg shape after view:  torch.Size([2, 64, 64])
	h_id shape after view:  torch.Size([2, 64, 16])
	h_mo shape after view:  torch.Size([2, 64, 64])
	h shape after input_attn:  torch.Size([2, 64, 144])
	h_bg shape after res*res:  torch.Size([2, 64, 8, 8])
	h_id shape after res*res:  torch.Size([2, 64, 4, 4])
	h_mo shape after res*res:  torch.Size([2, 64, 8, 8])
	in loop: 6
	append h_bg shape:  torch.Size([2, 64, 8, 8])
	append h_id shape:  torch.Size([2, 64, 4, 4])
	append h_mo shape:  torch.Size([2, 64, 8, 8])

	h_bg shape after module:  torch.Size([2, 128, 8, 8])
	h_id shape after module:  torch.Size([2, 128, 4, 4])
	h_mo shape after module:  torch.Size([2, 128, 8, 8])
	res, t:  8 4
	h_bg shape after view:  torch.Size([2, 128, 64])
	h_id shape after view:  torch.Size([2, 128, 16])
	h_mo shape after view:  torch.Size([2, 128, 64])
	h shape after input_attn:  torch.Size([2, 128, 144])
	h_bg shape after res*res:  torch.Size([2, 128, 8, 8])
	h_id shape after res*res:  torch.Size([2, 128, 4, 4])
	h_mo shape after res*res:  torch.Size([2, 128, 8, 8])
	in loop: 7
	append h_bg shape:  torch.Size([2, 128, 8, 8])
	append h_id shape:  torch.Size([2, 128, 4, 4])
	append h_mo shape:  torch.Size([2, 128, 8, 8])

	h_bg shape after module:  torch.Size([2, 128, 8, 8])
	h_id shape after module:  torch.Size([2, 128, 4, 4])
	h_mo shape after module:  torch.Size([2, 128, 8, 8])
	res, t:  8 4
	h_bg shape after view:  torch.Size([2, 128, 64])
	h_id shape after view:  torch.Size([2, 128, 16])
	h_mo shape after view:  torch.Size([2, 128, 64])
	h shape after input_attn:  torch.Size([2, 128, 144])
	h_bg shape after res*res:  torch.Size([2, 128, 8, 8])
	h_id shape after res*res:  torch.Size([2, 128, 4, 4])
	h_mo shape after res*res:  torch.Size([2, 128, 8, 8])
	in loop: 8
	append h_bg shape:  torch.Size([2, 128, 8, 8])
	append h_id shape:  torch.Size([2, 128, 4, 4])
	append h_mo shape:  torch.Size([2, 128, 8, 8])

	h_bg shape after module:  torch.Size([2, 128, 4, 4])
	h_id shape after module:  torch.Size([2, 128, 2, 2])
	h_mo shape after module:  torch.Size([2, 128, 4, 4])
	res, t:  4 2
	h_bg shape after view:  torch.Size([2, 128, 16])
	h_id shape after view:  torch.Size([2, 128, 4])
	h_mo shape after view:  torch.Size([2, 128, 16])
	h shape after input_attn:  torch.Size([2, 128, 36])
	h_bg shape after res*res:  torch.Size([2, 128, 4, 4])
	h_id shape after res*res:  torch.Size([2, 128, 2, 2])
	h_mo shape after res*res:  torch.Size([2, 128, 4, 4])
	in loop: 9
	append h_bg shape:  torch.Size([2, 128, 4, 4])
	append h_id shape:  torch.Size([2, 128, 2, 2])
	append h_mo shape:  torch.Size([2, 128, 4, 4])

	h_bg shape after module:  torch.Size([2, 128, 4, 4])
	h_id shape after module:  torch.Size([2, 128, 2, 2])
	h_mo shape after module:  torch.Size([2, 128, 4, 4])
	res, t:  4 2
	h_bg shape after view:  torch.Size([2, 128, 16])
	h_id shape after view:  torch.Size([2, 128, 4])
	h_mo shape after view:  torch.Size([2, 128, 16])
	h shape after input_attn:  torch.Size([2, 128, 36])
	h_bg shape after res*res:  torch.Size([2, 128, 4, 4])
	h_id shape after res*res:  torch.Size([2, 128, 2, 2])
	h_mo shape after res*res:  torch.Size([2, 128, 4, 4])
	in loop: 10
	append h_bg shape:  torch.Size([2, 128, 4, 4])
	append h_id shape:  torch.Size([2, 128, 2, 2])
	append h_mo shape:  torch.Size([2, 128, 4, 4])

	h_bg shape after module:  torch.Size([2, 128, 4, 4])
	h_id shape after module:  torch.Size([2, 128, 2, 2])
	h_mo shape after module:  torch.Size([2, 128, 4, 4])
	res, t:  4 2
	h_bg shape after view:  torch.Size([2, 128, 16])
	h_id shape after view:  torch.Size([2, 128, 4])
	h_mo shape after view:  torch.Size([2, 128, 16])
	h shape after input_attn:  torch.Size([2, 128, 36])
	h_bg shape after res*res:  torch.Size([2, 128, 4, 4])
	h_id shape after res*res:  torch.Size([2, 128, 2, 2])
	h_mo shape after res*res:  torch.Size([2, 128, 4, 4])
	in loop: 11
	append h_bg shape:  torch.Size([2, 128, 4, 4])
	append h_id shape:  torch.Size([2, 128, 2, 2])
	append h_mo shape:  torch.Size([2, 128, 4, 4])

start up sampling
cat out h shape:  torch.Size([2, 256, 2304])
show model_out in p_losses torch.Size([2, 256, 2304])
show encoding indices: torch.Size([2048])
show encodings: torch.Size([2048, 24576])
show encoding indices: torch.Size([512])
show encodings: torch.Size([512, 24576])
show encoding indices: torch.Size([2048])
show encodings: torch.Size([2048, 24576])
bg_quantized torch.Size([2, 1, 256, 32, 32])
id_quantized torch.Size([2, 1, 256, 16, 16])
mo_quantized torch.Size([2, 16, 256, 8, 8])
after rearrange quantized
xbg_quantized torch.Size([2, 256, 1024])
xid_quantized torch.Size([2, 256, 256])
xmo_quantized torch.Size([2, 256, 1024])
show z shape torch.Size([2, 256, 2304])
h shape:  torch.Size([2, 256, 2304])
h_bg shape:  torch.Size([2, 256, 32, 32])
h_id shape:  torch.Size([2, 256, 16, 16])
h_mo shape:  torch.Size([2, 256, 32, 32])
	h_bg shape after module:  torch.Size([2, 32, 32, 32])
	h_id shape after module:  torch.Size([2, 32, 16, 16])
	h_mo shape after module:  torch.Size([2, 32, 32, 32])
	res, t:  32 16
	h_bg shape after view:  torch.Size([2, 32, 1024])
	h_id shape after view:  torch.Size([2, 32, 256])
	h_mo shape after view:  torch.Size([2, 32, 1024])
	h shape after input_attn:  torch.Size([2, 32, 2304])
	h_bg shape after res*res:  torch.Size([2, 32, 32, 32])
	h_id shape after res*res:  torch.Size([2, 32, 16, 16])
	h_mo shape after res*res:  torch.Size([2, 32, 32, 32])
	in loop: 0
	append h_bg shape:  torch.Size([2, 32, 32, 32])
	append h_id shape:  torch.Size([2, 32, 16, 16])
	append h_mo shape:  torch.Size([2, 32, 32, 32])

	h_bg shape after module:  torch.Size([2, 32, 32, 32])
	h_id shape after module:  torch.Size([2, 32, 16, 16])
	h_mo shape after module:  torch.Size([2, 32, 32, 32])
	res, t:  32 16
	h_bg shape after view:  torch.Size([2, 32, 1024])
	h_id shape after view:  torch.Size([2, 32, 256])
	h_mo shape after view:  torch.Size([2, 32, 1024])
	h shape after input_attn:  torch.Size([2, 32, 2304])
	h_bg shape after res*res:  torch.Size([2, 32, 32, 32])
	h_id shape after res*res:  torch.Size([2, 32, 16, 16])
	h_mo shape after res*res:  torch.Size([2, 32, 32, 32])
	in loop: 1
	append h_bg shape:  torch.Size([2, 32, 32, 32])
	append h_id shape:  torch.Size([2, 32, 16, 16])
	append h_mo shape:  torch.Size([2, 32, 32, 32])

	h_bg shape after module:  torch.Size([2, 32, 32, 32])
	h_id shape after module:  torch.Size([2, 32, 16, 16])
	h_mo shape after module:  torch.Size([2, 32, 32, 32])
	res, t:  32 16
	h_bg shape after view:  torch.Size([2, 32, 1024])
	h_id shape after view:  torch.Size([2, 32, 256])
	h_mo shape after view:  torch.Size([2, 32, 1024])
	h shape after input_attn:  torch.Size([2, 32, 2304])
	h_bg shape after res*res:  torch.Size([2, 32, 32, 32])
	h_id shape after res*res:  torch.Size([2, 32, 16, 16])
	h_mo shape after res*res:  torch.Size([2, 32, 32, 32])
	in loop: 2
	append h_bg shape:  torch.Size([2, 32, 32, 32])
	append h_id shape:  torch.Size([2, 32, 16, 16])
	append h_mo shape:  torch.Size([2, 32, 32, 32])

	h_bg shape after module:  torch.Size([2, 32, 16, 16])
	h_id shape after module:  torch.Size([2, 32, 8, 8])
	h_mo shape after module:  torch.Size([2, 32, 16, 16])
	res, t:  16 8
	h_bg shape after view:  torch.Size([2, 32, 256])
	h_id shape after view:  torch.Size([2, 32, 64])
	h_mo shape after view:  torch.Size([2, 32, 256])
	h shape after input_attn:  torch.Size([2, 32, 576])
	h_bg shape after res*res:  torch.Size([2, 32, 16, 16])
	h_id shape after res*res:  torch.Size([2, 32, 8, 8])
	h_mo shape after res*res:  torch.Size([2, 32, 16, 16])
	in loop: 3
	append h_bg shape:  torch.Size([2, 32, 16, 16])
	append h_id shape:  torch.Size([2, 32, 8, 8])
	append h_mo shape:  torch.Size([2, 32, 16, 16])

	h_bg shape after module:  torch.Size([2, 64, 16, 16])
	h_id shape after module:  torch.Size([2, 64, 8, 8])
	h_mo shape after module:  torch.Size([2, 64, 16, 16])
	res, t:  16 8
	h_bg shape after view:  torch.Size([2, 64, 256])
	h_id shape after view:  torch.Size([2, 64, 64])
	h_mo shape after view:  torch.Size([2, 64, 256])
	h shape after input_attn:  torch.Size([2, 64, 576])
	h_bg shape after res*res:  torch.Size([2, 64, 16, 16])
	h_id shape after res*res:  torch.Size([2, 64, 8, 8])
	h_mo shape after res*res:  torch.Size([2, 64, 16, 16])
	in loop: 4
	append h_bg shape:  torch.Size([2, 64, 16, 16])
	append h_id shape:  torch.Size([2, 64, 8, 8])
	append h_mo shape:  torch.Size([2, 64, 16, 16])

	h_bg shape after module:  torch.Size([2, 64, 16, 16])
	h_id shape after module:  torch.Size([2, 64, 8, 8])
	h_mo shape after module:  torch.Size([2, 64, 16, 16])
	res, t:  16 8
	h_bg shape after view:  torch.Size([2, 64, 256])
	h_id shape after view:  torch.Size([2, 64, 64])
	h_mo shape after view:  torch.Size([2, 64, 256])
	h shape after input_attn:  torch.Size([2, 64, 576])
	h_bg shape after res*res:  torch.Size([2, 64, 16, 16])
	h_id shape after res*res:  torch.Size([2, 64, 8, 8])
	h_mo shape after res*res:  torch.Size([2, 64, 16, 16])
	in loop: 5
	append h_bg shape:  torch.Size([2, 64, 16, 16])
	append h_id shape:  torch.Size([2, 64, 8, 8])
	append h_mo shape:  torch.Size([2, 64, 16, 16])

	h_bg shape after module:  torch.Size([2, 64, 8, 8])
	h_id shape after module:  torch.Size([2, 64, 4, 4])
	h_mo shape after module:  torch.Size([2, 64, 8, 8])
	res, t:  8 4
	h_bg shape after view:  torch.Size([2, 64, 64])
	h_id shape after view:  torch.Size([2, 64, 16])
	h_mo shape after view:  torch.Size([2, 64, 64])
	h shape after input_attn:  torch.Size([2, 64, 144])
	h_bg shape after res*res:  torch.Size([2, 64, 8, 8])
	h_id shape after res*res:  torch.Size([2, 64, 4, 4])
	h_mo shape after res*res:  torch.Size([2, 64, 8, 8])
	in loop: 6
	append h_bg shape:  torch.Size([2, 64, 8, 8])
	append h_id shape:  torch.Size([2, 64, 4, 4])
	append h_mo shape:  torch.Size([2, 64, 8, 8])

	h_bg shape after module:  torch.Size([2, 128, 8, 8])
	h_id shape after module:  torch.Size([2, 128, 4, 4])
	h_mo shape after module:  torch.Size([2, 128, 8, 8])
	res, t:  8 4
	h_bg shape after view:  torch.Size([2, 128, 64])
	h_id shape after view:  torch.Size([2, 128, 16])
	h_mo shape after view:  torch.Size([2, 128, 64])
	h shape after input_attn:  torch.Size([2, 128, 144])
	h_bg shape after res*res:  torch.Size([2, 128, 8, 8])
	h_id shape after res*res:  torch.Size([2, 128, 4, 4])
	h_mo shape after res*res:  torch.Size([2, 128, 8, 8])
	in loop: 7
	append h_bg shape:  torch.Size([2, 128, 8, 8])
	append h_id shape:  torch.Size([2, 128, 4, 4])
	append h_mo shape:  torch.Size([2, 128, 8, 8])

	h_bg shape after module:  torch.Size([2, 128, 8, 8])
	h_id shape after module:  torch.Size([2, 128, 4, 4])
	h_mo shape after module:  torch.Size([2, 128, 8, 8])
	res, t:  8 4
	h_bg shape after view:  torch.Size([2, 128, 64])
	h_id shape after view:  torch.Size([2, 128, 16])
	h_mo shape after view:  torch.Size([2, 128, 64])
	h shape after input_attn:  torch.Size([2, 128, 144])
	h_bg shape after res*res:  torch.Size([2, 128, 8, 8])
	h_id shape after res*res:  torch.Size([2, 128, 4, 4])
	h_mo shape after res*res:  torch.Size([2, 128, 8, 8])
	in loop: 8
	append h_bg shape:  torch.Size([2, 128, 8, 8])
	append h_id shape:  torch.Size([2, 128, 4, 4])
	append h_mo shape:  torch.Size([2, 128, 8, 8])

	h_bg shape after module:  torch.Size([2, 128, 4, 4])
	h_id shape after module:  torch.Size([2, 128, 2, 2])
	h_mo shape after module:  torch.Size([2, 128, 4, 4])
	res, t:  4 2
	h_bg shape after view:  torch.Size([2, 128, 16])
	h_id shape after view:  torch.Size([2, 128, 4])
	h_mo shape after view:  torch.Size([2, 128, 16])
	h shape after input_attn:  torch.Size([2, 128, 36])
	h_bg shape after res*res:  torch.Size([2, 128, 4, 4])
	h_id shape after res*res:  torch.Size([2, 128, 2, 2])
	h_mo shape after res*res:  torch.Size([2, 128, 4, 4])
	in loop: 9
	append h_bg shape:  torch.Size([2, 128, 4, 4])
	append h_id shape:  torch.Size([2, 128, 2, 2])
	append h_mo shape:  torch.Size([2, 128, 4, 4])

	h_bg shape after module:  torch.Size([2, 128, 4, 4])
	h_id shape after module:  torch.Size([2, 128, 2, 2])
	h_mo shape after module:  torch.Size([2, 128, 4, 4])
	res, t:  4 2
	h_bg shape after view:  torch.Size([2, 128, 16])
	h_id shape after view:  torch.Size([2, 128, 4])
	h_mo shape after view:  torch.Size([2, 128, 16])
	h shape after input_attn:  torch.Size([2, 128, 36])
	h_bg shape after res*res:  torch.Size([2, 128, 4, 4])
	h_id shape after res*res:  torch.Size([2, 128, 2, 2])
	h_mo shape after res*res:  torch.Size([2, 128, 4, 4])
	in loop: 10
	append h_bg shape:  torch.Size([2, 128, 4, 4])
	append h_id shape:  torch.Size([2, 128, 2, 2])
	append h_mo shape:  torch.Size([2, 128, 4, 4])

	h_bg shape after module:  torch.Size([2, 128, 4, 4])
	h_id shape after module:  torch.Size([2, 128, 2, 2])
	h_mo shape after module:  torch.Size([2, 128, 4, 4])
	res, t:  4 2
	h_bg shape after view:  torch.Size([2, 128, 16])
	h_id shape after view:  torch.Size([2, 128, 4])
	h_mo shape after view:  torch.Size([2, 128, 16])
	h shape after input_attn:  torch.Size([2, 128, 36])
	h_bg shape after res*res:  torch.Size([2, 128, 4, 4])
	h_id shape after res*res:  torch.Size([2, 128, 2, 2])
	h_mo shape after res*res:  torch.Size([2, 128, 4, 4])
	in loop: 11
	append h_bg shape:  torch.Size([2, 128, 4, 4])
	append h_id shape:  torch.Size([2, 128, 2, 2])
	append h_mo shape:  torch.Size([2, 128, 4, 4])

start up sampling
cat out h shape:  torch.Size([2, 256, 2304])
show model_out in p_losses torch.Size([2, 256, 2304])
